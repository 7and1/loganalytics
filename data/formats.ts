import type { LogFormat } from "@/types/content";

export const formats: LogFormat[] = [
  {
    slug: "nginx-access-log",
    name: "Nginx Access Log",
    description: "Default combined log format shipped with Nginx, ideal for traffic and latency triage.",
    category: "Web Server",
    fileExtension: ".log",
    regex: String.raw`^(?<remote_addr>\S+) - (?<remote_user>\S+) \[(?<time_local>[^\]]+)\] "(?<request>[^"]+)" (?<status>\d+) (?<body_bytes_sent>\d+) "(?<http_referer>[^"]*)" "(?<http_user_agent>[^"]*)"`,
    duckdb_schema: "remote_addr VARCHAR, remote_user VARCHAR, time_local VARCHAR, request VARCHAR, status INTEGER, body_bytes_sent INTEGER, http_referer VARCHAR, http_user_agent VARCHAR",
    sample_line: '192.168.1.1 - - [23/Nov/2025:10:00:00 +0000] "GET /index.html HTTP/1.1" 200 1024 "-" "Mozilla/5.0"',
    common_errors: ["502", "404", "499"],
    meta_title: "Nginx Access Log Analyzer (DuckDB in Browser)",
    meta_desc: "Parse and query Nginx access logs locally with DuckDB-Wasm. No uploads, instant filtering.",
    relatedErrors: ["502", "404"],
  },
  {
    slug: "apache-combined-log",
    name: "Apache Combined Log",
    description: "The de-facto Apache HTTP Server log string with referer and user agent fields.",
    category: "Web Server",
    fileExtension: ".log",
    regex: String.raw`^(?<ip>\S+) (?<identd>\S+) (?<user>\S+) \[(?<time>[^\]]+)\] "(?<request>[^"]+)" (?<status>\d{3}) (?<bytes>\d+|-) "(?<referer>[^"]*)" "(?<agent>[^"]*)"`,
    duckdb_schema: "ip VARCHAR, identd VARCHAR, user VARCHAR, time VARCHAR, request VARCHAR, status INTEGER, bytes INTEGER, referer VARCHAR, agent VARCHAR",
    sample_line: '10.0.0.1 - john [23/Nov/2025:11:00:00 +0000] "POST /submit HTTP/1.1" 201 532 "https://example.org" "curl/7.81.0"',
    common_errors: ["500", "503", "408"],
    meta_title: "Apache Combined Log Parser (100% Client-side)",
    meta_desc: "Drop Apache logs into your browser and run SQL with DuckDB. Privacy-first analytics.",
  },
  {
    slug: "aws-s3-access-log",
    name: "AWS S3 Access Log",
    description: "Server access logs for S3 buckets. Analyze costs, traffic sources, and error rates.",
    category: "Cloud",
    fileExtension: ".txt",
    regex: String.raw`^([^ ]+) ([^ ]+) \[(.*?)\] ([^ ]+) ([^ ]+) ([^ ]+) ([^ ]+) ([^ ]+) "([^"]*)" (-|[0-9]+) ([^ ]+) ([^ ]+) ([^ ]+) ([^ ]+) ([^ ]+) "([^"]*)" "([^"]*)" ([^ ]+)`,
    duckdb_schema: "bucket_owner VARCHAR, bucket VARCHAR, time_local VARCHAR, remote_ip VARCHAR, requester VARCHAR, request_id VARCHAR, operation VARCHAR, key VARCHAR, request_line VARCHAR, status VARCHAR, error_code VARCHAR, bytes_sent VARCHAR, object_size VARCHAR, total_time VARCHAR, turn_around_time VARCHAR, referer VARCHAR, user_agent VARCHAR, version_id VARCHAR",
    sample_line: '79a59df900b949e5559695974416186f9d6a3666b68595679234567890abcdef my-bucket [06/Feb/2019:00:00:38 +0000] 192.0.2.3 - 7B4A0F9000000000 REST.GET.OBJECT my-image.jpg "GET /my-image.jpg HTTP/1.1" 200 - - 1234 12 12 "-" "Mozilla/5.0" -',
    defaultSqlQuery: "SELECT status, count(*) AS count FROM log_table GROUP BY status ORDER BY count DESC",
    common_errors: ["AccessDenied", "SlowDown", "NoSuchKey"],
    meta_title: "AWS S3 Server Access Log Decoder",
    meta_desc: "Turn AWS S3 server access logs into structured DuckDB tables for cost and threat analysis.",
    relatedErrors: ["AccessDenied"],
  },
  {
    slug: "cloudfront-standard-log",
    name: "Amazon CloudFront Standard Log",
    description: "Edge delivery log containing cache behaviors, edge response time, and viewer IPs.",
    category: "CDN",
    fileExtension: ".log",
    regex: String.raw`^(?<date>\S+)\s+(?<time>\S+)\s+(?<edge_location>\S+)\s+(?<bytes_sent>\d+)\s+(?<ip>\S+)\s+(?<method>\S+)\s+(?<host>\S+)\s+(?<uri_stem>\S+)\s+(?<status>\d{3})\s+(?<referer>\S+)\s+(?<user_agent>\S+)\s+(?<uri_query>\S+)\s+(?<cookie>\S+)\s+(?<result_type>\S+)\s+(?<result_id>\S+)\s+(?<host_header>\S+)\s+(?<request_id>\S+)\s+(?<request_bytes>\d+)\s+(?<time_taken>\S+)\s+(?<x_forwarded_for>\S+)\s+(?<ssl_protocol>\S+)\s+(?<ssl_cipher>\S+)\s+(?<response_result_type>\S+)`,
    duckdb_schema: "date VARCHAR, time VARCHAR, edge_location VARCHAR, bytes_sent BIGINT, ip VARCHAR, method VARCHAR, host VARCHAR, uri_stem VARCHAR, status INTEGER, referer VARCHAR, user_agent VARCHAR, uri_query VARCHAR, cookie VARCHAR, result_type VARCHAR, result_id VARCHAR, host_header VARCHAR, request_id VARCHAR, request_bytes BIGINT, time_taken DOUBLE, x_forwarded_for VARCHAR, ssl_protocol VARCHAR, ssl_cipher VARCHAR, response_result_type VARCHAR",
    sample_line: "2025-11-23\t10:10:10\tSFO5\t2390\t203.0.113.5\tGET\td3c7.cloudfront.net\t/content.js\t200\t-\tMozilla/5.0\t-\t-\tMiss\t-\td3c7.cloudfront.net\t3kEzyx\t512\t0.028\t-\tTLSv1.3\tTLS_AES_128_GCM_SHA256\tHit",
    common_errors: ["502", "504", "EdgeTimeout"],
    meta_title: "CloudFront Log Explorer",
    meta_desc: "Profile cache hits, viewer geos, and TLS posture directly in the browser.",
  },
  {
    slug: "docker-json-log",
    name: "Docker JSON Log",
    description: "Default container log driver output (json-file) used by Docker Engine.",
    category: "Containers",
    fileExtension: ".json",
    regex: String.raw`^\{"log":"(?<message>.*)","stream":"(?<stream>\w+)","time":"(?<time>[^"]+)"\}$`,
    duckdb_schema: "message VARCHAR, stream VARCHAR, time TIMESTAMP",
    sample_line: '{"log":"GET /health 200","stream":"stdout","time":"2025-11-23T10:00:00.000000000Z"}',
    common_errors: ["OOMKilled", "CrashLoopBackOff", "ContainerWait"],
    meta_title: "Docker JSON Log Flattener",
    meta_desc: "Slice container stdout/stderr locally and join with infra metadata instantly.",
  },
  {
    slug: "kubernetes-ingress-nginx",
    name: "Kubernetes Ingress Nginx",
    description: "Ingress-Nginx controller log with request identifiers and upstream timings.",
    category: "Kubernetes",
    fileExtension: ".log",
    regex: String.raw`^(?<remote_addr>\S+) - (?<remote_user>\S+) \[(?<time_local>[^\]]+)\] "(?<request>[^"]+)" (?<status>\d+) (?<body_bytes_sent>\d+) "(?<http_referer>[^"]*)" "(?<http_user_agent>[^"]*)" (?<request_length>\d+) (?<request_time>\S+) (?<proxy_upstream_name>\S+) (?<upstream_addr>\S+) (?<upstream_response_time>\S+) (?<upstream_status>\d+)`,
    duckdb_schema: "remote_addr VARCHAR, remote_user VARCHAR, time_local VARCHAR, request VARCHAR, status INTEGER, body_bytes_sent INTEGER, http_referer VARCHAR, http_user_agent VARCHAR, request_length INTEGER, request_time DOUBLE, proxy_upstream_name VARCHAR, upstream_addr VARCHAR, upstream_response_time DOUBLE, upstream_status INTEGER",
    sample_line: '203.0.113.9 - - [23/Nov/2025:11:11:11 +0000] "GET /api HTTP/2.0" 200 344 "-" "kube-probe" 512 0.003 upstream-default-backend 10.244.0.12:8080 0.002 200',
    common_errors: ["429", "503", "upstream_timeout"],
    meta_title: "Kubernetes Ingress Log Decoder",
    meta_desc: "Pinpoint upstream saturation directly from Ingress logs and keep data on the cluster.",
  },
  {
    slug: "mysql-general-query-log",
    name: "MySQL General Query Log",
    description: "Full statement log capturing every query hitting a MySQL instance, useful for auditing.",
    category: "Database",
    fileExtension: ".log",
    regex: String.raw`^(?<time>\d{6}\s+\d{1,2}:\d{2}:\d{2})\s+(?<thread>\d+)\s+(?<command>\w+)\s+(?<argument>.*)$`,
    duckdb_schema: "time VARCHAR, thread INTEGER, command VARCHAR, argument VARCHAR",
    sample_line: "251123 11:12:13\t123 Connect\troot@localhost on",
    common_errors: ["TooManyConnections", "LockWaitTimeout", "Deadlock"],
    meta_title: "MySQL General Log Inspector",
    meta_desc: "Surface noisy SQL and auth issues straight from general logs using DuckDB in your tab.",
  },
  {
    slug: "postgresql-server-log",
    name: "PostgreSQL Server Log",
    description: "Configurable log_line_prefix layout with severity, pid, and connection metadata.",
    category: "Database",
    fileExtension: ".log",
    regex: String.raw`^(?<timestamp>\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2}\.\d+ UTC) \[(?<pid>\d+)\] (?<user>[^@]+)@(?<database>\S+) (?<level>[A-Z]+): (?<message>.*)$`,
    duckdb_schema: "timestamp TIMESTAMP, pid INTEGER, user VARCHAR, database VARCHAR, level VARCHAR, message VARCHAR",
    sample_line: "2025-11-23 11:14:05.123 UTC [1024] postgres@analytics LOG: connection authorized",
    common_errors: ["deadlock_detected", "statement_timeout", "disk_full"],
    meta_title: "Postgres Log Classifier",
    meta_desc: "Stream PostgreSQL logs into structured DuckDB tables to hunt for slow or failed statements.",
    relatedErrors: ["deadlock_detected"],
  },
  {
    slug: "windows-iis-log",
    name: "Windows IIS W3C Log",
    description: "W3C extended format produced by Internet Information Services web servers.",
    category: "Web Server",
    fileExtension: ".log",
    regex: String.raw`^(?<date>\d{4}-\d{2}-\d{2})\s+(?<time>\d{2}:\d{2}:\d{2})\s+(?<s_ip>\S+)\s+(?<cs_method>\S+)\s+(?<cs_uri_stem>\S+)\s+(?<cs_uri_query>\S*)\s+(?<s_port>\d+)\s+(?<cs_username>\S*)\s+(?<c_ip>\S+)\s+(?<cs_user_agent>\S+)\s+(?<sc_status>\d{3})\s+(?<sc_substatus>\d+)\s+(?<sc_win32_status>\d+)\s+(?<time_taken>\d+)$`,
    duckdb_schema: "date DATE, time TIME, s_ip VARCHAR, cs_method VARCHAR, cs_uri_stem VARCHAR, cs_uri_query VARCHAR, s_port INTEGER, cs_username VARCHAR, c_ip VARCHAR, cs_user_agent VARCHAR, sc_status INTEGER, sc_substatus INTEGER, sc_win32_status INTEGER, time_taken INTEGER",
    sample_line: "2025-11-23 10:15:30 10.1.4.5 GET /default.aspx id=1 443 - 203.0.113.1 Mozilla/5.0 200 0 0 31",
    common_errors: ["500", "503", "404"],
    meta_title: "IIS Log Visualizer",
    meta_desc: "Use DuckDB-Wasm to triage IIS W3C logs with zero infrastructure.",
  },
  {
    slug: "gcp-load-balancer-log",
    name: "GCP HTTP Load Balancer Log",
    description: "Structured text export for Google Cloud HTTP(S) Load Balancers (classic logging).",
    category: "Cloud Networking",
    fileExtension: ".log",
    regex: String.raw`^(?<timestamp>\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}\.\d+Z)\s+(?<elb>\S+)\s+(?<client_ip>\S+):(?<client_port>\d+)\s+(?<backend_ip>\S+):(?<backend_port>\d+)\s+(?<request_processing_time>\S+)\s+(?<backend_processing_time>\S+)\s+(?<response_processing_time>\S+)\s+(?<elb_status_code>\d{3})\s+(?<backend_status_code>\d{3})\s+(?<received_bytes>\d+)\s+(?<sent_bytes>\d+)\s+"(?<request>[^"]+)"\s+(?<user_agent>\S+)\s+(?<ssl_cipher>\S+)\s+(?<ssl_protocol>\S+)\s+(?<target_group_arn>\S+)\s+(?<trace_id>\S+)`,
    duckdb_schema: "timestamp TIMESTAMP, elb VARCHAR, client_ip VARCHAR, client_port INTEGER, backend_ip VARCHAR, backend_port INTEGER, request_processing_time DOUBLE, backend_processing_time DOUBLE, response_processing_time DOUBLE, elb_status_code INTEGER, backend_status_code INTEGER, received_bytes BIGINT, sent_bytes BIGINT, request VARCHAR, user_agent VARCHAR, ssl_cipher VARCHAR, ssl_protocol VARCHAR, target_group_arn VARCHAR, trace_id VARCHAR",
    sample_line: '2025-11-23T10:20:00.000Z prod-lb 198.51.100.9:45000 10.0.0.5:8080 0.0002 0.005 0.0004 200 200 1024 2048 "GET https://loganalytics.org/health HTTP/1.1" Mozilla/5.0 TLS_AES_256_GCM_SHA384 TLSv1.3 target-groups/prod trace-1',
    common_errors: ["499", "502", "ELB5xx"],
    meta_title: "GCP LB Log Explorer",
    meta_desc: "Understand latency spikes across Google Cloud load balancers without leaving the browser.",
  },
  {
    slug: "postgres-log",
    name: "PostgreSQL Error Log",
    description: "Classic PostgreSQL server log with PID, user, database, severity, and free-form message fields.",
    category: "Database",
    fileExtension: ".log",
    regex: String.raw`^(?<timestamp>\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2} [A-Z]+) \[(?<pid>\d+)\] (?<role>[^@]+)@(?<database>\S+) (?<level>[A-Z]+): (?<message>.*)$`,
    duckdb_schema: "timestamp VARCHAR, pid INTEGER, role VARCHAR, database VARCHAR, level VARCHAR, message VARCHAR",
    sample_line: '2025-11-23 12:45:01 UTC [12345] analytics@prod ERROR: relation "orders" does not exist',
    common_errors: ["deadlock_detected", "lock_not_available", "syntax_error"],
    meta_title: "PostgreSQL Error Log Parser",
    meta_desc: "Unpack PostgreSQL server logs locally to debug lock waits, slow queries, and fatal errors without shipping data.",
    relatedErrors: ["deadlock_detected"],
  },
  {
    slug: "cloudfront-log",
    name: "CloudFront Access Log",
    description: "Amazon CloudFront standard log with header comments and dozens of edge metrics.",
    category: "CDN",
    fileExtension: ".log",
    regex: String.raw`^(?<date>\d{4}-\d{2}-\d{2})\s+(?<time>\d{2}:\d{2}:\d{2})\s+(?<x_edge_location>\S+)\s+(?<sc_bytes>\d+)\s+(?<c_ip>\S+)\s+(?<cs_method>\S+)\s+(?<cs_host>\S+)\s+(?<cs_uri_stem>\S+)\s+(?<sc_status>\d{3})\s+(?<cs_referer>\S+)\s+(?<cs_user_agent>\S+)\s+(?<cs_uri_query>\S*)\s+(?<cs_cookie>\S*)\s+(?<x_edge_result_type>\S+)\s+(?<x_edge_request_id>\S+)\s+(?<x_host_header>\S+)\s+(?<cs_protocol>\S+)\s+(?<cs_bytes>\d+)\s+(?<time_taken>\S+)\s+(?<x_forwarded_for>\S*)\s+(?<ssl_protocol>\S*)\s+(?<ssl_cipher>\S*)\s+(?<x_edge_response_result_type>\S+)$`,
    duckdb_schema: "date VARCHAR, time VARCHAR, x_edge_location VARCHAR, sc_bytes BIGINT, c_ip VARCHAR, cs_method VARCHAR, cs_host VARCHAR, cs_uri_stem VARCHAR, sc_status INTEGER, cs_referer VARCHAR, cs_user_agent VARCHAR, cs_uri_query VARCHAR, cs_cookie VARCHAR, x_edge_result_type VARCHAR, x_edge_request_id VARCHAR, x_host_header VARCHAR, cs_protocol VARCHAR, cs_bytes BIGINT, time_taken DOUBLE, x_forwarded_for VARCHAR, ssl_protocol VARCHAR, ssl_cipher VARCHAR, x_edge_response_result_type VARCHAR",
    sample_line: '2025-11-23 10:11:12 DFW3 2390 203.0.113.5 GET d3c7.cloudfront.net /content.js 200 - Mozilla/5.0 - - Miss example.cloudfront.net https 640 0.028 - TLSv1.3 TLS_AES_128_GCM_SHA256 Hit',
    common_errors: ["502", "503", "504"],
    meta_title: "CloudFront Access Log Decoder",
    meta_desc: "Skip the AWS console—drag CloudFront logs into your browser and slice cache misses instantly.",
    relatedErrors: ["504"],
  },
  {
    slug: "k8s-json",
    name: "Kubernetes JSON Log",
    description: "Raw JSON entries emitted by container runtimes with embedded pod metadata.",
    category: "Kubernetes",
    fileExtension: ".json",
    regex: String.raw`^(?<json_line>\{.*\})$`,
    duckdb_schema: "json_line VARCHAR",
    sample_line: '{"log":"GET /health 200","stream":"stdout","kubernetes":{"pod_name":"api-5c7b","namespace_name":"prod"}}',
    common_errors: ["CrashLoopBackOff", "ImagePullBackOff", "OOMKilled"],
    meta_title: "Kubernetes JSON Log Flattening",
    meta_desc: "Bring k8s structured logs into DuckDB and json_extract only the fields you need—all in your browser.",
    relatedErrors: ["OOMKilled"],
  },
  {
    slug: "android-logcat",
    name: "Android Logcat",
    description: "Classic logcat lines with PID/TID, priority, tag, and free-form message for mobile debugging.",
    category: "Mobile",
    fileExtension: ".log",
    regex: String.raw`^(?<date>\d{2}-\d{2})\s+(?<time>\d{2}:\d{2}:\d{2}\.\d+)\s+(?<pid>\d+)\s+(?<tid>\d+)\s+(?<priority>[VDIWEAF])\s+(?<tag>[^:]+):\s+(?<message>.*)$`,
    duckdb_schema: "date VARCHAR, time VARCHAR, pid INTEGER, tid INTEGER, priority VARCHAR, tag VARCHAR, message VARCHAR",
    sample_line: "11-23 14:35:12.345 1234 5678 D ActivityManager: Start proc com.example for activity com.example/.MainActivity",
    common_errors: ["E", "F", "W"],
    meta_title: "Android Logcat Analyzer",
    meta_desc: "Paste adb logcat output and hunt for ANRs, crashes, and noisy tags with instant SQL.",
  },
  {
    slug: "heroku-router",
    name: "Heroku Router Log",
    description: "Router lines showing dyno routing, latency, bytes, and request metadata for Heroku apps.",
    category: "PaaS",
    fileExtension: ".log",
    regex: String.raw`^(?<timestamp>\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}\.\d+\+\d{2}:\d{2}) (?<source>\S+): at=(?<at>\S+) method=(?<method>\S+) path="(?<path>[^"]+)" host=(?<host>\S+) request_id=(?<request_id>\S+) fwd="(?<fwd>[^"]*)" dyno=(?<dyno>\S+) connect=(?<connect>\S+) service=(?<service>\S+) status=(?<status>\d+) bytes=(?<bytes>\d+) protocol=(?<protocol>\S+)$`,
    duckdb_schema: "timestamp VARCHAR, source VARCHAR, at VARCHAR, method VARCHAR, path VARCHAR, host VARCHAR, request_id VARCHAR, fwd VARCHAR, dyno VARCHAR, connect VARCHAR, service VARCHAR, status INTEGER, bytes INTEGER, protocol VARCHAR",
    sample_line: '2025-11-23T15:42:10.123456+00:00 heroku[router]: at=info method=GET path="/api/v1/users" host=app.herokuapp.com request_id=1234abcd fwd="1.2.3.4" dyno=web.1 connect=1ms service=15ms status=200 bytes=2450 protocol=https',
    common_errors: ["H12", "H18", "H31"],
    meta_title: "Heroku Router Log Explorer",
    meta_desc: "Surface H12 timeouts and routing anomalies from heroku[router] lines without ever leaving your browser.",
  },
] satisfies LogFormat[];

export default formats;
